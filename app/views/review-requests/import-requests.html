{% extends 'reviewlayout.html' %}

{% set pageName = "Import requests" %}
{% set containerClass = "nhsuk-width-container-fluid" %}


<!-- For adding a breadcrumb or back link -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/breadcrumbs and https://service-manual.nhs.uk/design-system/components/back-link -->
{% block beforeContent %}
{% endblock %}


{% block content %}
<main>
<div class="fullscreen-table">

 
 
    

<h1>Import requests</h1>

{% from 'details/macro.njk' import details %}

{% call details({
  summaryText: "Filter requests",
  classes: "nhsuk-expander"
}) %}
<div class="nhsuk-grid-row">
 <div class="nhsuk-grid-column-one-third">
 {% from 'input/macro.njk' import input %}

{{ input({
  label: {
    text: "Requested by"
  },
  hint: {
    text: "Enter full or partial email address"
  },
  id: "RequestedBy",
  name: "RequestedBy"
}) }}
</div>

<div class="nhsuk-grid-column-one-third">

{{ input({
  label: {
    text: "Agreement"
  },
  hint: {
    text: "Enter full or partial DSA number"
  },
  id: "Agreement",
  name: "Agreement"
}) }}
</div>

<div class="nhsuk-grid-column-one-third">
{{ input({
  label: {
    text: "Output checker"
  },
  hint: {
    text: "Enter full or partial email address"
  },
  id: "OutputChecker",
  name: "OutputChecker"
}) }}
 </div>
</div>

<div class="nhsuk-grid-row">
 

<div class="nhsuk-grid-column-one-third">
{% from 'date-input/macro.njk' import dateInput %}

{{ dateInput({
  id: "DateStart",
  namePrefix: "DateStart",
  fieldset: {
    legend: {
      text: "Date range start",
      classes: "nhsuk-label"
    }
  },

  items: [
    {
      name: "day",
      classes: "nhsuk-input--width-2"
    },
    {
      name: "month",
      classes: "nhsuk-input--width-2"
    },
    {
      name: "year",
      classes: "nhsuk-input--width-4"
    }
  ]
}) }}
</div>

<div class="nhsuk-grid-column-one-third">
{% from 'date-input/macro.njk' import dateInput %}

{{ dateInput({
  id: "DateStart",
  namePrefix: "DateEnd",
  fieldset: {
    legend: {
      text: "Date range end",
      classes: "nhsuk-label"
    }
  },

  items: [
    {
      name: "day",
      classes: "nhsuk-input--width-2"
    },
    {
      name: "month",
      classes: "nhsuk-input--width-2"
    },
    {
      name: "year",
      classes: "nhsuk-input--width-4"
    }
  ]
}) }}
</div>
</div>


{% from 'button/macro.njk' import button %}

{{ button({
  text: "Apply filters"
}) }}

{% endcall %}

    {% from 'tabs/macro.njk' import tabs %} 
{% from 'tables/macro.njk' import table %}


{% set AssignedToMe %}  
  <div>
    <h2 class="nhsuk-heading-s">Pending requests</h2>
    <p>10 pending requests, ordered by 'priority' then 'request date' (oldest to newest)</p>
  </div>

  {{ table({
    responsive: false,
    panel: false,
    caption: "",
    firstCellIsHeader: false,
    head: [
      { text: "ID" },
      { text: "File name", format: "text" },
      { text: "Type" },
      { text: "Request date", format: "text" },
      { text: "Requested by", format: "text" },
      { text: "Agreement", format: "text" },
      { text: "Import checker", format: "text" },
      { text: "Action", format: "text" }
    ],
    rows: [
      [
        { text: "1001" },
        { html: '<a class="nhsuk-link" href="/requests/1001">patient-1001.json</a>' },
        { text: "Code" },
      
        { text: "2025-11-09 14:22" },
        { text: "research.data@oxford.ac.uk" },
        { text: "DSA-4829-1503" },
        { text: "j.turner@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="make-decision-import">Make decision</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ],
      [
        { text: "1002" },
        { html: '<a class="nhsuk-link" href="/requests/1002">export-wardB-1002.zip</a>' },
        { text: "Code" },
        
        { text: "2025-11-09 11:03" },
        { text: "data.access@imperial.ac.uk" },
        { text: "DSA-0391-7742" },
        { text: "k.patel@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="make-decision-import">Make decision</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ],
      [
        { text: "1003" },
        { html: '<a class="nhsuk-link" href="/requests/1003">clinic-report-1003.csv</a>' },
        { text: "Reference data" },
        
        { text: "2025-11-08 16:45" },
        { text: "info@ucl-research.ac.uk" },
        { text: "DSA-6612-3008" },
        { text: "m.oneill@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="make-decision-import">Make decision</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ]
    ]
    
  }) }}

{% endset -%}


{% set Unassigned %}  
  <div>
    <h2 class="nhsuk-heading-s">Unassigned pending requests</h2>
    {% from 'button/macro.njk' import button %}
    {{ button({ text: "Assign selected requests" }) }}
    <p>10 pending requests, ordered by 'priority' then 'request date' (oldest to newest)</p>
  </div>

  {{ table({
    responsive: false,
    panel: false,
    caption: "",
    firstCellIsHeader: false,
    head: [
      { html: '<input type="checkbox" id="selectAllUnassigned" class="app-checkbox-header" aria-label="Select all unassigned requests">' },
      { text: "ID" },
      { text: "File name", format: "text" },
      { text: "Type" },
      
      { text: "Request date", format: "text" },
      { text: "Requested by", format: "text" },
      { text: "Agreement", format: "text" },
      { text: "Import checker", format: "text" },
      { text: "Action", format: "text" }
    ],
    rows: [
      [
        { html: '<input type="checkbox" name="unassignedRequest" value="2001" class="app-checkbox">' },
        { text: "2001" },
        { html: '<a class="nhsuk-link" href="/requests/2001">patient-2001.json</a>' },
        { text: "Reference data" },
        
        { text: "2025-11-08 10:12" },
        { text: "research.team@ox.ac.uk" },
        { text: "DSA-1234-5678" },
        { text: "a.smith@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/2001/assign">Assign</a>' }
      ]
    ]
  }) }}



{% endset -%}

{% set Assigned %}  
  <div>
    <h2 class="nhsuk-heading-s">Assigned pending requests</h2>
    <p>10 pending requests, ordered by 'priority' then 'request date' (oldest to newest)</p>
  </div>
  {{ table({
    responsive: false,
    panel: false,
    caption: "",
    firstCellIsHeader: false,
    head: [
      { text: "ID" },
      { text: "File name", format: "text" },
      { text: "Type" },
      
      { text: "Request date", format: "text" },
      { text: "Requested by", format: "text" },
      { text: "Agreement", format: "text" },
      { text: "Import checker", format: "text" },
      { text: "Action", format: "text" }
    ],
    rows: [
      [
        { text: "3001" },
        { html: '<a class="nhsuk-link" href="/requests/3001">study-export-3001.json</a>' },
        { text: "Code" },
        
        { text: "2025-10-15 12:00" },
        { text: "research@manchester.ac.uk" },
        { text: "DSA-2222-3333" },
        { text: "c.wilson@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Make decision</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ],
      [
        { text: "3002" },
        { html: '<a class="nhsuk-link" href="/requests/3002">clinic-report-3002.csv</a>' },
        { text: "Reference data" },
       
        { text: "2025-10-20 15:30" },
        { text: "info@ucl-research.ac.uk" },
        { text: "DSA-4444-5555" },
        { text: "d.brown@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Make decision</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ],
      [
        { text: "3003" },
        { html: '<a class="nhsuk-link" href="/requests/3003">patient-3003.json</a>' },
        { text: "Code" },
       
        { text: "2025-10-22 09:10" },
        { text: "research.data@ox.ac.uk" },
        { text: "DSA-5555-6666" },
        { text: 'b.jones@nhs.net' },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Assign to me</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ]
    ]
  }) }}
{% endset -%}

{% set allPending %}  
  <div>
    <h2 class="nhsuk-heading-s">All pending requests</h2>
    <p>10 pending requests, ordered by 'priority' then 'request date' (oldest to newest)</p>
  </div>
  {{ table({
    responsive: false,
    panel: false,
    caption: "",
    firstCellIsHeader: false,
    head: [
      { text: "ID" },
      { text: "File name", format: "text" },
      { text: "Type" },
      
      { text: "Request date", format: "text" },
      { text: "Requested by", format: "text" },
      { text: "Agreement", format: "text" },
      { text: "Import checker", format: "text" },
      { text: "Action", format: "text" }
    ],
    rows: [
      [
        { text: "4001" },
        { html: '<a class="nhsuk-link" href="/requests/4001">batch-export-4001.tar.gz</a>' },
        { text: "Reference data" },
       
        { text: "2025-01-05 08:20" },
        { text: "research@kcl.ac.uk" },
        { text: "DSA-9999-0000" },
        { html: '<span class="nhsuk-u-secondary-text-colour">Unassigned</span>' },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Assign</a>'}
      ],
      [
        { text: "4002" },
        { html: '<a class="nhsuk-link" href="/requests/4002">ward-summary-4002.xlsx</a>' },
        { text: "Code" },
       
        { text: "2025-02-11 10:45" },
        { text: "enquiries@edinburgh-research.ac.uk" },
        { text: "DSA-1010-2020" },
        { html: '<span class="nhsuk-u-secondary-text-colour">Unassigned</span>' },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Assign</a>'}
      ],
      [
        { text: "4003" },
        { html: '<a class="nhsuk-link" href="/requests/4003">patient-4003.json</a>' },
        { text: "Code" },
        
        { text: "2025-03-12 09:30" },
        { text: "research.data@oxford.ac.uk" },
        { text: "DSA-2020-3030" },
        { text: "g.brown@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Make decision</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ],
      [
        { text: "4004" },
        { html: '<a class="nhsuk-link" href="/requests/4004">study-export-4004.json</a>' },
        { text: "Reference data" },
       
        { text: "2025-04-01 11:10" },
        { text: "studies@manchester.ac.uk" },
        { text: "DSA-3030-4040" },
        { text: "h.fox@nhs.net" },
        { html: '<a class="nhsuk-link no-wrap" href="/requests/1006/assign">Assign to me</a><br>
                  <a class="nhsuk-link" href="/requests/1006/unassign">Unassign</a>'}
      ]
    ]
  }) }}
{% endset -%}



{{ tabs({ 
  items: [ 
    { 
      label: "Assigned to me (3)", 
      id: "past-day", 
      panel: { 
        html: AssignedToMe 
      } 
    }, 
    { 
      label: "Unassigned (1)", 
      id: "past-week", 
      panel: { 
        html: Unassigned 
      } 
    }, 
    { 
      label: "Assigned (3)", 
      id: "past-month", 
      panel: { 
        html: Assigned 
      } 
    },  
    { 
      label: "All pending (4)", 
      id: "past-year", 
      panel: { 
        html: allPending 
      } 
    },
    { 
      label: "Actioned", 
      id: "actioned", 
      panel: { 
        html: actioned 
      } 
    } 
  ] 
}) }}

</div> 
</main>
 
{% block pageScripts %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const selectAllCheckbox = document.getElementById('selectAllUnassigned');
    const individualCheckboxes = document.querySelectorAll('input[name="unassignedRequest"]');
    
    if (selectAllCheckbox) {
      selectAllCheckbox.addEventListener('change', function() {
        individualCheckboxes.forEach(checkbox => {
          checkbox.checked = this.checked;
        });
      });
      
      // Update select all checkbox when individual checkboxes change
      individualCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const allChecked = Array.from(individualCheckboxes).every(cb => cb.checked);
          const someChecked = Array.from(individualCheckboxes).some(cb => cb.checked);
          selectAllCheckbox.checked = allChecked;
          selectAllCheckbox.indeterminate = someChecked && !allChecked;
        });
      });
    }
  });
</script>
{% endblock %}

</main>
 
{% endblock %}
